<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_212) on Mon Aug 12 12:41:29 PDT 2019 -->
<title>AsMavenPlugin (goomph 3.18.0 API)</title>
<meta name="date" content="2019-08-12">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AsMavenPlugin (goomph 3.18.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><h2><a href="https://github.com/diffplug/goomph" style="text-transform: none;">com.diffplug.gradle:goomph:3.18.0</a> by <a href="https://www.diffplug.com" style="text-transform: none;">DiffPlug</a></h2></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/diffplug/gradle/p2/AsMavenGroup.html" title="class in com.diffplug.gradle.p2"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/diffplug/gradle/p2/FeaturesAndBundlesPublisher.html" title="class in com.diffplug.gradle.p2"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/diffplug/gradle/p2/AsMavenPlugin.html" target="_top">Frames</a></li>
<li><a href="AsMavenPlugin.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.diffplug.gradle.p2</div>
<h2 title="Class AsMavenPlugin" class="title">Class AsMavenPlugin</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../com/diffplug/gradle/ProjectPlugin.html" title="class in com.diffplug.gradle">com.diffplug.gradle.ProjectPlugin</a></li>
<li>
<ul class="inheritance">
<li>com.diffplug.gradle.p2.AsMavenPlugin</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="https://docs.gradle.org/5.1/javadoc/org/gradle/api/Plugin.html?is-external=true" title="class or interface in org.gradle.api">Plugin</a>&lt;<a href="https://docs.gradle.org/5.1/javadoc/org/gradle/api/Project.html?is-external=true" title="class or interface in org.gradle.api">Project</a>&gt;</dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">AsMavenPlugin</span>
extends <a href="../../../../com/diffplug/gradle/ProjectPlugin.html" title="class in com.diffplug.gradle">ProjectPlugin</a></pre>
<div class="block"><p>Downloads a set of artifacts from a p2 repository
and stuffs them into a local maven repository in the
<code>build/p2asmaven</code> folder, then adds this repository
to the project.</p>
<pre><code class="language-groovy">apply plugin: 'com.diffplug.gradle.p2.asmaven'
p2AsMaven {
    // the maven group they shall have
    group 'eclipse-deps', {
        // the repositories and artifacts to download
        repoEclipse '4.5.2'
        iu          'org.eclipse.jdt.core'
    }
}

dependencies {
    compile 'eclipse-deps:org.eclipse.jdt.core:+'
}
</code></pre>
<p>You can also specify multiple groups, as such</p>
<pre><code class="language-groovy">def SUPPORTED_VERSIONS = ['4.4', '4.5', '4.6']
p2AsMaven {
    for (version in SUPPORTED_VERSIONS) {
        group 'eclipse-deps-' + version, {
            repoEclipse version
            iu 'org.eclipse.swt'
            // this will cause any OSGi jars which ask to be expanded into
            // folders to be exploded, e.g. Eclipse-BundleShape: dir 
            repo2runnable()
        }
    }
}

// build folder will look like this:
build/p2AsMaven/
    maven/
        eclipse-deps-4.4/
        eclipse-deps-4.5/
        eclipse-deps-4.6/
    p2/
        eclipse-deps-4.4/
        eclipse-deps-4.5/
        eclipse-deps-4.6/
    p2runnable/
        eclipse-deps-4.4/
        eclipse-deps-4.5/
        eclipse-deps-4.6/
</code></pre>
<p>The maven repository does not contain any dependency information,
just the raw jars.  In the example above, when p2 downloads
<code>org.eclipse.jdt.core</code>, it also downloads all of its dependencies.
But none of these dependencies are added automatically - you have to
add them yourself.</p>
<h2><a href="#example-projects" id="example-projects">Example projects</a></h2>
<ul>
<li><a href="https://github.com/diffplug/spotless" target="_top">spotless</a></li>
<li>(send us yours in a <a href="https://github.com/diffplug/goomph" target="_top">PR</a>!)</li>
</ul>
<h2><a href="#proxy-support" id="proxy-support">Proxy support</a></h2>
<p>If you need to pass through a proxy, you&rsquo;ll need to create a file
called <code>proxies.ini</code> with content like this:</p>
<pre><code class="language-ini">org.eclipse.core.net/proxyData/HTTP/host=someproxy.ericsson.se
org.eclipse.core.net/proxyData/HTTPS/host=someproxy.ericsson.se
org.eclipse.core.net/proxyData/HTTPS/hasAuth=false
org.eclipse.core.net/proxyData/HTTP/port=8080
org.eclipse.core.net/proxyData/HTTPS/port=8080
org.eclipse.core.net/org.eclipse.core.net.hasMigrated=true
org.eclipse.core.net/nonProxiedHosts=*.ericsson.com|127.0.0.1
org.eclipse.core.net/systemProxiesEnabled=false
org.eclipse.core.net/proxyData/HTTP/hasAuth=false 
</code></pre>
<p>Once you&rsquo;ve done this, add this to your <code>build.gradle</code>:</p>
<pre><code class="language-groovy">p2AsMaven {
    group 'myGroup', {
        ...
        p2ant {
            it.addArg('plugincustomization', '&lt;path to proxies.ini&gt;')
        }
    }
}
</code></pre>
<p>If you think this is too hard, vote for <a href="https://github.com/diffplug/goomph/issues/12" target="_top">this issue on GitHub</a>
and <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=382875" target="_top">this bug on eclipse</a> and we can make it easier.</p>
<h2><a href="#slicing-options" id="slicing-options">Slicing options</a></h2>
<p>You can control how the iu&rsquo;s are resolved using</p>
<pre><code class="language-groovy">p2AsMaven {
  group 'eclipse-deps', {
    ...
    slicingOption 'latestVersionOnly', 'true'
  }
}
</code></pre>
<p>You can see all the available slicing options <a href="https://wiki.eclipse.org/Equinox/p2/Ant_Tasks#SlicingOptions" target="_top">here</a>.</p>
<h2><a href="#append-option" id="append-option">Append option</a></h2>
<p>You can control whether iu&rsquo;s should be appended to destination repository
true: already downloaded iu&rsquo;s are preserved, new iu&rsquo;s are downloaded into the existing repo
false: Default value for goomph, repository will be completely cleared before download new iu&rsquo;s</p>
<ul>
<li>
<pre><code class="language-groovy"></code></pre>
</li>
</ul>
<p>p2AsMaven {
group &lsquo;eclipse-deps&rsquo;, {
&hellip;
append true
}
}</p>
<pre><code>
More info [here]{https://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Fguide%2Fp2_repositorytasks.htm}.

## Acknowledgements and comparisons to other options

Inspired by Andrey Hihlovskiy's [unpuzzle](https://github.com/akhikhl/unpuzzle).
Unpuzzle downloads a zipped-up copy of the eclipse IDE and stuffs its jars into a
maven repository.  Additionally, it parses out the `Require-Bundle` directives to
put partial dependency information in the maven metadata.

Simon Templer has a [fork](https://github.com/stempler/unpuzzle) which supports parsing
the `Import-Package` and `Export-Package` directive to build even more detailed
dependency information.

A third option is Dr. David Akehurst's [p2 dependency resolver](https://github.com/dhakehurst/net.akehurst.build.gradle),
which is a partial re-implementation of P2, and uses internal gradle APIs to hook into
Gradle's dependency resolution.  It's very impressive, but it has a few limitations:

- It does not support composite repositories
- It does not work on Gradle &gt; 2.8

All of the above are great work, and served as useful examples.  The central
problem which is the cause of so many not-quite-satisfying implementations is this:

- Using the real p2 is cumbersome, but possible.
- Re-implementing the first 70% of p2 is easy, but the last 30% is hard and moving (they're still adding features).
- Gradle doesn't yet have an extensible API for repositories.

In Goomph, we will always use the real p2.  While we work around limitations in
gradle and p2, we will only use public APIs in both products.</code></pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../com/diffplug/gradle/p2/AsMavenPlugin.html#AsMavenPlugin--">AsMavenPlugin</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/diffplug/gradle/p2/AsMavenPlugin.html#applyOnce-org.gradle.api.Project-">applyOnce</a></span>(<a href="https://docs.gradle.org/5.1/javadoc/org/gradle/api/Project.html?is-external=true" title="class or interface in org.gradle.api">Project</a>&nbsp;project)</code>
<div class="block">Plugin application, which is guaranteed to execute only once.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/diffplug/gradle/p2/AsMavenExtension.html" title="class in com.diffplug.gradle.p2">AsMavenExtension</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/diffplug/gradle/p2/AsMavenPlugin.html#extension--">extension</a></span>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.diffplug.gradle.ProjectPlugin">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.diffplug.gradle.<a href="../../../../com/diffplug/gradle/ProjectPlugin.html" title="class in com.diffplug.gradle">ProjectPlugin</a></h3>
<code><a href="../../../../com/diffplug/gradle/ProjectPlugin.html#apply-org.gradle.api.Project-">apply</a>, <a href="../../../../com/diffplug/gradle/ProjectPlugin.html#getPlugin-org.gradle.api.Project-java.lang.Class-">getPlugin</a>, <a href="../../../../com/diffplug/gradle/ProjectPlugin.html#treeDef--">treeDef</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="AsMavenPlugin--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>AsMavenPlugin</h4>
<pre>public&nbsp;AsMavenPlugin()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="applyOnce-org.gradle.api.Project-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>applyOnce</h4>
<pre>protected&nbsp;void&nbsp;applyOnce(<a href="https://docs.gradle.org/5.1/javadoc/org/gradle/api/Project.html?is-external=true" title="class or interface in org.gradle.api">Project</a>&nbsp;project)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../../../../com/diffplug/gradle/ProjectPlugin.html#applyOnce-org.gradle.api.Project-">ProjectPlugin</a></code></span></div>
<div class="block"><p>Plugin application, which is guaranteed to execute only once.</p></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../com/diffplug/gradle/ProjectPlugin.html#applyOnce-org.gradle.api.Project-">applyOnce</a></code>&nbsp;in class&nbsp;<code><a href="../../../../com/diffplug/gradle/ProjectPlugin.html" title="class in com.diffplug.gradle">ProjectPlugin</a></code></dd>
</dl>
</li>
</ul>
<a name="extension--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>extension</h4>
<pre>public&nbsp;<a href="../../../../com/diffplug/gradle/p2/AsMavenExtension.html" title="class in com.diffplug.gradle.p2">AsMavenExtension</a>&nbsp;extension()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><h2><a href="https://github.com/diffplug/goomph" style="text-transform: none;">com.diffplug.gradle:goomph:3.18.0</a> by <a href="https://www.diffplug.com" style="text-transform: none;">DiffPlug</a></h2><script type="text/javascript" charset="utf-8" src="../../../../highlight.pack.js"></script>
<script type="text/javascript"><!--
var cssId = 'highlightCss';
if (!document.getElementById(cssId))
{
    var head  = document.getElementsByTagName('head')[0];
    var link  = document.createElement('link');
    link.id   = cssId;
    link.rel  = 'stylesheet';
    link.type = 'text/css';
    link.charset = 'utf-8';
    link.href = '../../../../highlight.css';
    link.media = 'all';
    head.appendChild(link);
}hljs.initHighlightingOnLoad();
//--></script></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/diffplug/gradle/p2/AsMavenGroup.html" title="class in com.diffplug.gradle.p2"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/diffplug/gradle/p2/FeaturesAndBundlesPublisher.html" title="class in com.diffplug.gradle.p2"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/diffplug/gradle/p2/AsMavenPlugin.html" target="_top">Frames</a></li>
<li><a href="AsMavenPlugin.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
